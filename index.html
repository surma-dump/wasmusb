<!doctype html>
<button disabled>Connect to camera</button>
<!-- <script src="a.out.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/comlinkjs@2.3.0/comlink.global.min.js"></script>
<script>
  const worker = new Worker('worker.js');
  const btn = document.querySelector('button');
  btn.disabled = false;
  let device;

  Comlink.expose({
    async getUsbPermission(devices) {
      await new Promise(resolve => btn.onclick = resolve);
      device = await navigator.usb.requestDevice({filters: devices});
      return {
        vendorId: device.vendorId,
        productId: device.productId,
      };
    }
  }, worker);
</script>
